{"version":3,"sources":["data-request-v0.0.0.js","start-v0.0.0.js","gallery-v0.0.0.js","iframe-list-v0.0.0.js","main-v0.0.0.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"gears-a8020d31.js","sourcesContent":["require.register('data-request/index', function(require, exports, module) {var request = require('utils/request');\n\nexports.getJson = function (jsonName, callback) {\n\trequest.get('/json/' + jsonName + '.json', function (res) {\n\t\tif (res.status === 200) {\n\t\t\tvar json = JSON.parse(res.text);\n\t\t\tcallback(json);\n\t\t}\n\t});\n};\n\nexports.getText = function (textName, callback) {\n\trequest.get('/texter/' + textName, function (res) {\n\t\tif (res.status === 200) {\n\t\t\tcallback(res.text);\n\t\t}\n\t});\n};\n\nexports.get = request.get;});\nwindow.cogwheels.addFeature({name: \"data-request\", version: \"0.0.0\"});","require.register('start/index', function(require, exports, module) {var router = require('router');\nvar main = require('main');\nvar bus = require('message-bus');\n\nexports.start = function () {\n    var firstRender = true;\n    router.on('/', function (ctx) {\n            main.render();\n            firstRender = false;\n        }\n    );\n    router.on('/:page', function (ctx) {\n            var page = ctx.params.page;\n            if (page.indexOf('#') === 0) {\n                page = page.substr(1);\n                if (!firstRender) {\n                    bus.publish('main-content', page);\n                } else {\n                    firstRender = false;\n                    main.render(page);\n                }\n            }\n        }\n    );\n};\n\nexports.controllers = [];});\nwindow.cogwheels.addFeature({name: \"start\", version: \"0.0.0\"});","require.register('gallery/index', function(require, exports, module) {var template = require('./template');\nvar viewModel = require('./view-model');\n\nexports.init = function () {\n    ko.components.register('gallery', component);\n};\n\nvar component = {\n    viewModel: {\n        'createViewModel': viewModel.create\n    },\n    template: template\n};});\nrequire.register('gallery/template', function(require, exports, module) {module.exports = \"<div class=\\\"photos\\\"><div class=\\\"fotorama\\\" data-auto=\\\"false\\\" data-nav=\\\"thumbs\\\" data-bind=\\\"attr:{'data-width':width, 'data-height':height}\\\"></div></div>\";});\nrequire.register('gallery/view-model', function(require, exports, module) {var request = require('data-request');\n\nfunction setSize(obj) {\n    var mainContent = $('.mainContent');\n    obj.width = mainContent.width();\n    obj.height = mainContent.height() - 80;\n}\nvar viewModel = {\n    init: function (params) {\n        var self = this;\n        setSize(this);\n        request.getJson(params.jsonName, function (images) {\n            setTimeout(function () {\n                images.forEach(function (image) {\n                    image.caption = image.text;\n                    image.img = image.url;\n                    image.thumb = image.url;\n                    image.full = image.url;\n                });\n                var fotorama = $('.fotorama').fotorama({\n                    data: images,\n                    allowfullscreen: true,\n                    autoplay: '5000',\n                    loop: true,\n                    arrows: 'always',\n                    shuffle: true\n                });\n                $(window).resize(function () {\n                    var resize = {};\n                    setSize(resize);\n                    fotorama.resize(resize);\n                });\n            }, 0);\n        });\n    }\n};\n\n\nmodule.exports.create = function (params) {\n    var vm = Object.create(viewModel);\n    vm.init(params);\n    return vm;\n};\n});\nwindow.cogwheels.addFeature({name: \"gallery\", version: \"0.0.0\"});","require.register('iframe-list/index', function(require, exports, module) {var template = require('./template');\nvar viewModel = require('./view-model');\n\nexports.init = function () {\n    ko.components.register('iframe-list', component);\n};\n\nvar component = {\n    viewModel: {\n        'createViewModel': viewModel.create\n    },\n    template: template\n};});\nrequire.register('iframe-list/template', function(require, exports, module) {module.exports = \"<div class=\\\"lazyIFrames\\\" data-bind=\\\"foreach: items\\\"><div class=\\\"card\\\" data-bind=\\\"style: {width: width}\\\"><div class=\\\"iFrameTitle\\\" data-bind=\\\"text: title\\\"></div><paper-shadow z=\\\"2\\\" style=\\\"background-size: 100%\\\" data-bind=\\\"style: {backgroundImage: image, width: width, height: height}\\\"><div data-bind=\\\"click: $parent.click, css: $parent.playIconClass\\\"><div class=\\\"replaceMe\\\"></div></div></paper-shadow></div></div>\";});\nrequire.register('iframe-list/view-model', function(require, exports, module) {var viewModel = {\n    init: function (params) {\n        this.playIconClass = 'play ' + params.playIconClass;\n        this.items = params.items;\n        this.click = showIFrame;\n    }\n};\n\nfunction showIFrame(item, event) {\n    var element = event.currentTarget;\n    var iframe = document.createElement('iframe');\n    var iframeUrl = item.iFrameUrl;\n    if (element.getAttribute('data-params')) {\n        iframeUrl += '&' + element.getAttribute('data-params');\n    }\n    iframe.setAttribute('src', iframeUrl);\n    iframe.setAttribute('frameborder', '0');\n    if (item.fill) {\n        iframe.style.width = element.parentElement.style.width;\n        iframe.style.height = element.parentElement.style.height;\n    } else {\n        iframe.style.display = 'block';\n    }\n    element.replaceChild(iframe, element.querySelector('.replaceMe'));\n    element.className = 'play';\n}\n\nmodule.exports.create = function (params) {\n    var vm = Object.create(viewModel);\n    vm.init(params);\n    return vm;\n};\n});\nwindow.cogwheels.addFeature({name: \"iframe-list\", version: \"0.0.0\"});","require.register('main/index', function(require, exports, module) {var layoutEngine = require('layout-engine');\nvar template = require('./template');\nvar viewModel = require('./view-model').create();\nvar request = require('data-request');\n\nvar urlPage;\n\nexports.init = function () {\n    request.getJson('menu', function (sections) {\n        sections.forEach(function (section) {\n            if (!section.header) {\n                var name = section.id || section.text.toLowerCase();\n                var component = {\n                    viewModel: {\n                        'createViewModel': function () {\n                            var viewModel = require('./' + name + '/view-model');\n                            var vm = Object.create(viewModel);\n                            vm.init();\n                            return vm;\n                        }\n                    },\n                    template: require('./' + name + '/template')\n                };\n                ko.components.register(name, component);\n            }\n        });\n        viewModel.createSections(urlPage);\n    });\n};\n\nexports.render = function (page) {\n    urlPage = page;\n    layoutEngine.render(template, viewModel, 'site');\n};});\nrequire.register('main/template', function(require, exports, module) {module.exports = \"<div class=\\\"main\\\"><div class=\\\"navbar navbar-default navbar-fixed-top\\\" role=\\\"navigation\\\"><div class=\\\"container\\\"><div class=\\\"navbar-header\\\"><button type=\\\"button\\\" class=\\\"navbar-toggle animated rollIn\\\" data-toggle=\\\"offcanvas\\\" data-target=\\\".sidebar-nav\\\"><span class=\\\"icon-bar\\\"></span> <span class=\\\"icon-bar\\\"></span> <span class=\\\"icon-bar\\\"></span></button> <img class=\\\"drawerPhoto\\\" src=\\\"/img/drawer_photo.jpg\\\"> <img class=\\\"logo\\\" src=\\\"/img/logo.png\\\"></div></div></div><div class=\\\"container\\\"><div class=\\\"row row-offcanvas row-offcanvas-left\\\"><div class=\\\"col-xs-6 col-sm-2 sidebar-offcanvas\\\" id=\\\"sidebar\\\" role=\\\"navigation\\\"><ul class=\\\"nav\\\" data-bind=\\\"foreach: sections\\\"><li class=\\\"item\\\" data-bind=\\\"click: select, css: {'item-selected' : selected(), 'animated flash': initPage(), 'menu-header': header}, text:text\\\"></li></ul></div><div class=\\\"col-xs-12 col-sm-10 mainContent\\\" data-bind=\\\"if: mainContent()\\\"><div data-bind=\\\"component: {name: mainContent}\\\"></div></div></div></div></div>\";});\nrequire.register('main/view-model', function(require, exports, module) {var bus = require('message-bus');\nvar request = require('data-request');\nvar router = require('router');\n\nvar viewModel = {\n    init: function () {\n        var self = this;\n        self.mainContent = ko.observable('');\n        self.sections = ko.observableArray();\n        bus.subscribe('main-content', function (item) {\n            var section = item.data.toLowerCase();\n            self.mainContent(section);\n        });\n    },\n    createSections: function (selected) {\n        var self = this;\n        request.getJson('menu', function (sections) {\n            sections.forEach(function (section, index) {\n                section.initPage = ko.observable(false);\n                section.header = section.header || false;\n                section.id = section.id || section.text.toLowerCase();\n                section.selected = ko.computed(function () {\n                    return section.id === self.mainContent();\n                });\n                section.select = function () {\n                    if (!section.header) {\n                        router.navigate('/#' + section.id);\n                        document.querySelector('#sidebar').parentElement.className = 'row row-offcanvas row-offcanvas-left';\n                    }\n                };\n                if (!selected) {\n                    if (section.startPage) {\n                        section.select();\n                        section.initPage(true);\n                    }\n                }\n                self.sections.push(section);\n            });\n            if (selected)  {\n                bus.publish('main-content', selected);\n            }\n        });\n    }\n};\n\n\nmodule.exports.create = function () {\n    var vm = Object.create(viewModel);\n    vm.init();\n    return vm;\n};\n});\nrequire.register('main/bilder-artist/template', function(require, exports, module) {module.exports = \"<gallery params=\\\"jsonName: 'bilder-artist'\\\"></gallery>\";});\nrequire.register('main/bilder-artist/view-model', function(require, exports, module) {module.exports = {\n    init: function () {\n    }\n};\n});\nrequire.register('main/bilder-trubadur/template', function(require, exports, module) {module.exports = \"<gallery params=\\\"jsonName: 'bilder-trubadur'\\\"></gallery>\";});\nrequire.register('main/bilder-trubadur/view-model', function(require, exports, module) {module.exports = {\n    init: function () {\n    }\n};\n});\nrequire.register('main/discografi/template', function(require, exports, module) {module.exports = \"<div data-bind=\\\"visible:loading\\\" class=\\\"animated fadeIn\\\">Läser in album...</div><!--ko if: !loading()--><div data-bind=\\\"if: albums().length === 0\\\">Inga album upplagda för tillfället. Återkom gärna senare!</div><div data-bind=\\\"foreach: albums\\\"><div class=\\\"card discography animated fadeIn\\\" data-bind=\\\"if: hasImage\\\"><div class=\\\"discoInfo\\\"><div class=\\\"discoYear\\\" data-bind=\\\"text: date\\\"></div><div horizontal layout justified><div class=\\\"discoTitle\\\" data-bind=\\\"text: title\\\"></div><div class=\\\"discoTrackCount\\\"><span data-bind=\\\"text: trackCount() + ' spår'\\\"></span></div></div></div><div style=\\\"background-size: 100%\\\" data-bind=\\\"style: {backgroundImage: image, width: width, height: height}\\\"></div><div class=\\\"discoLinks\\\" horizontal end-justified layout center><a href=\\\"\\\" target=\\\"_blank\\\" data-bind=\\\"visible: shopUrl, attr:{href: shopUrl}\\\"><img class=\\\"shoppingCart\\\" src=\\\"img/shopping-cart.png\\\" border=\\\"0\\\"></a> <a href=\\\"\\\" target=\\\"_blank\\\" data-bind=\\\"attr:{href: iTunesUrl}\\\"><img src=\\\"img/itunes.png\\\" border=\\\"0\\\"></a> <a href=\\\"\\\" target=\\\"_blank\\\" data-bind=\\\"attr:{href: spotifyUrl}\\\"><img src=\\\"img/spotify-logo-32x32-no-tagline.png\\\" border=\\\"0\\\"></a></div></div></div><!--/ko-->\";});\nrequire.register('main/discografi/view-model', function(require, exports, module) {var request = require('data-request');\n\nmodule.exports = {\n    init: function () {\n        var self = this;\n        self.albums = ko.observableArray();\n        this.loading = ko.observable(true);\n        request.getJson('spotify_albums', function (albums) {\n            self.loading(false);\n            albums.forEach(function (album) {\n                album.spotifyUrl = 'http://open.spotify.com/album/' + album.spotifyId;\n                album.iTunesUrl = 'https://itunes.apple.com/us/album/' + album.iTunesId;\n                album.shopUrl = album.shopId ? 'http://davidmiles.tictail.com/product/' + album.shopId : false;\n                album.title = ko.observable();\n                album.date = ko.observable();\n                album.trackCount = ko.observable();\n                album.image = ko.observable();\n                album.width = '250px';\n                album.height = '250px';\n                album.hasImage = ko.computed(function() {\n                    return album.image() !== undefined;\n                });\n                request.get('https://api.spotify.com/v1/albums/' + album.spotifyId, function (result) {\n                    if (!result.body.error) {\n                        var images = result.body.images;\n                        album.title(result.body.name);\n                        album.date(result.body['release_date'].replace(/-.*/, ''));\n                        album.trackCount(result.body.tracks.items.length);\n                        images.forEach(function (image) {\n                            if (image.height === 300) {\n                                album.image('url(' + image.url + ')');\n                            }\n                        });\n                    } else {\n                        self.albums.remove(album);\n                    }\n                });\n                self.albums.push(album);\n            });\n        });\n    }\n};});\nrequire.register('main/gastbok/template', function(require, exports, module) {module.exports = \"<iframe src=\\\"http://www.gastbok.nu/gb/54314/\\\" width=\\\"100%\\\" height=\\\"100%\\\" frameborder=\\\"0\\\"></iframe>\";});\nrequire.register('main/gastbok/view-model', function(require, exports, module) {module.exports = {\n    init: function () {\n\n    }\n};});\nrequire.register('main/hem/template', function(require, exports, module) {module.exports = \"<div><p>David Miles är en låtskrivare, gitarrist och sångare uppvuxen i Göteborg men numera bosatt i Malmö. Han har gett ut 3 skivor sedan 2008. Den senaste skivan <a href=\\\"http://open.spotify.com/album/5nrPJLz8D9BAwBkUYyISWi\\\">Tiden är ett jetplan</a> gavs ut hösten 2012.</p><p>2011 hade David en radiohit med låten <a href=\\\"http://open.spotify.com/album/5RyzFjnNSYWYHdP5Nn9SDp\\\">Det är bara så det är</a>.</p><p>Många krogar, restauranger, eventbolag mm bokar David som trubadur. Efter flera år som flitig underhållare på uteserveringar och pubar runt om i landet är han med sitt genuina och äkta sound alltid mycket omtyckt.</p><p>David medverkar även i <a href=\\\"\\\" data-bind=\\\"click:goToPodcast\\\">podcasten Sjöwall & Miles</a> där det släpps ett nytt avsnitt ungefär en gång i månaden.</p><div center-justified><paper-shadow z=\\\"1\\\" class=\\\"card homeImage\\\"><img src=\\\"/img/spelplan.jpg\\\"></paper-shadow><paper-shadow z=\\\"1\\\" class=\\\"card homeImage\\\"><img src=\\\"/img/press/david_press_7_medium.jpg\\\"></paper-shadow></div><div class=\\\"musicServices\\\" horizontal center-justified layout><a href=\\\"http://www.facebook.com/pages/David-Miles/155341767874341\\\" target=\\\"_blank\\\"><img src=\\\"img/facebook.jpeg\\\" border=\\\"0\\\"></a> <a href=\\\"http://open.spotify.com/artist/4z4NwEHgD7Ykjs1L0gsKCI\\\" target=\\\"_blank\\\"><img src=\\\"img/spotify-logo-32x32-no-tagline.png\\\" border=\\\"0\\\"></a> <a href=\\\"https://itunes.apple.com/us/artist/david-miles/id304549972\\\" target=\\\"_blank\\\"><img src=\\\"img/itunes.png\\\" border=\\\"0\\\"></a></div></div>\";});\nrequire.register('main/hem/view-model', function(require, exports, module) {var bus = require('message-bus');\n\nmodule.exports = {\n    init: function () {\n\n    },\n    goToTrubadur: function() {\n        bus.publish('main-content', 'info-trubadur');\n    },\n    goToPodcast: function() {\n        bus.publish('main-content', 'podcast');\n    }\n\n};});\nrequire.register('main/info-trubadur/template', function(require, exports, module) {module.exports = \"Här ska det finnas text om trubaduren\";});\nrequire.register('main/info-trubadur/view-model', function(require, exports, module) {var request = require('data-request');\n\nmodule.exports = {\n    init: function () {\n\n    }\n};});\nrequire.register('main/kontakt/template', function(require, exports, module) {module.exports = \"<div><div class=\\\"marginBottom\\\">Kontakta David Miles på<div>E-post: <a href=\\\"mailto:david@davidmiles.se\\\">david@davidmiles.se</a></div><div>Telefon: <a href=\\\"tel:0706-979604\\\">0706-979604</a></div></div><paper-shadow z=\\\"1\\\" class=\\\"contactImage\\\"><img src=\\\"img/press/david_press_18.jpg\\\"></paper-shadow><div class=\\\"marginBottom\\\" vertical layout>Kontakta skivbolag på <a href=\\\"http://www.hansarenmusik.se\\\" target=\\\"_blank\\\">www.hansarenmusik.se</a></div><div horizontal layout><div>Sidan är skapad av</div><a class=\\\"spaced\\\" href=\\\"https://se.linkedin.com/in/johanfrick\\\">Johan Frick</a></div></div>\";});\nrequire.register('main/kontakt/view-model', function(require, exports, module) {module.exports = {\n    init: function () {\n\n    }\n};});\nrequire.register('main/press/template', function(require, exports, module) {module.exports = \"<div vertical layout center><b>Pressmeddelande</b> <a href=\\\"/img/130607_davidmiles.se_pressmeddelande.pdf\\\" target=\\\"_blank\\\">2013-06-07 David Miles Konserter sommaren 2013</a> <a href=\\\"/img/121016_davidmiles.se_pressmeddelande.pdf\\\" target=\\\"_blank\\\">2012-10-16 David Miles släpper nya skivan Tiden är ett jetplan!</a> <a href=\\\"/img/120625_davidmiles.se_pressmeddelande.pdf\\\" target=\\\"_blank\\\">2012-06-25 David Miles ger ut ny skiva hösten 2012!</a> <b class=\\\"pressImages\\\">Pressbilder</b><div data-bind=\\\"foreach: images\\\"><paper-shadow z=\\\"2\\\" class=\\\"card\\\"><a data-bind=\\\"attr: {href: url, 'data-title': downloadLink}\\\" data-lightbox=\\\"image-1\\\" data-title=\\\"\\\"><img data-bind=\\\"attr: {src: thumb}\\\"></a></paper-shadow></div></div>\";});\nrequire.register('main/press/view-model', function(require, exports, module) {module.exports = {\n    init: function () {\n        var images = [];\n        for (var i = 1; i <= 22; i++) {\n            var fullUrl = 'img/press/david_press_' + i + '.jpg';\n            images.push(\n                {\n                    thumb: 'img/press/david_press_' + i + '_thumbnail.jpg',\n                    url: fullUrl,\n                    downloadLink: '<a href=\"' + fullUrl + '\" target=\"_blank\">Klicka här för att ladda ner</a>'\n                }\n            );\n        }\n        this.images = images;\n    }\n};});\nrequire.register('main/podcast/template', function(require, exports, module) {module.exports = \"<img class=\\\"max100\\\" src=\\\"/img/podcast.jpg\\\"><div class=\\\"podcasts\\\"><div class=\\\"animated fadeIn\\\" data-bind=\\\"if:podcasts().length === 0\\\">Inga podcasts tillgängliga</div><div data-bind=\\\"foreach: podcasts\\\"><div class=\\\"animated fadeIn\\\"><a href=\\\"\\\" data-bind=\\\"attr:{href: url}, text: title\\\" target=\\\"_blank\\\"></a></div></div></div>\";});\nrequire.register('main/podcast/view-model', function(require, exports, module) {var request = require('data-request');\n\nmodule.exports = {\n    init: function () {\n        var self = this;\n        this.podcasts = ko.observableArray([{title: 'Läser in podcast-listan...', url: ''}]);\n        request.getJson('podcast', function (podcasts) {\n            podcasts.forEach(function (podcast) {\n                podcast.url = 'http://sjowallmiles.podomatic.com/entry/' + podcast.podomaticId;\n            });\n            self.podcasts(podcasts);\n        });\n    }\n};\n});\nrequire.register('main/recensioner/template', function(require, exports, module) {module.exports = \"<div class=\\\"reviews\\\" data-bind=\\\"foreach: items\\\"><!--ko if: hasImage--><img class=\\\"reviewAlbums\\\" src=\\\"\\\" data-bind=\\\"attr: {src: albumImage}\\\"><!--/ko--><!--ko if: hasText --><div><a href=\\\"\\\" target=\\\"_blank\\\" data-bind=\\\"attr: {href: link}, text: text\\\"></a></div><!--/ko--></div>\";});\nrequire.register('main/recensioner/view-model', function(require, exports, module) {var request = require('data-request');\n\nmodule.exports = {\n    init: function () {\n        var self = this;\n        this.items = ko.observableArray();\n        request.getJson('recensioner', function (items) {\n            items.forEach(function(item) {\n                item.hasImage = item.albumImage !== undefined;\n                item.hasText = item.text !== undefined;\n            });\n            self.items(items);\n        });\n    }\n};});\nrequire.register('main/referenser/template', function(require, exports, module) {module.exports = \"<div horizontal center-justified layout wrap data-bind=\\\"foreach: references\\\"><div vertical layout class=\\\"quote\\\"><div data-bind=\\\"text:text\\\" class=\\\"quoteText\\\"></div><div data-bind=\\\"text:source\\\" class=\\\"quoteSource\\\"></div></div></div>\";});\nrequire.register('main/referenser/view-model', function(require, exports, module) {var request = require('data-request');\n\nmodule.exports = {\n    init: function () {\n        this.references = ko.observableArray();\n        request.getJson('referenser', function(references) {\n            references.forEach(function(reference) {\n               reference.text = '”' + reference.text + '”';\n            });\n            this.references(references);\n        }.bind(this));\n    }\n};});\nrequire.register('main/shop/template', function(require, exports, module) {module.exports = \"Shoppen öppnas i ett nytt fönster. <a href=\\\"http://davidmiles.tictail.com/\\\">Klicka här</a> för att öppna den igen.\";});\nrequire.register('main/shop/view-model', function(require, exports, module) {module.exports = {\n    init: function () {\n        var win = window.open('http://davidmiles.tictail.com/', '_blank');\n        win.focus();\n    }\n};});\nrequire.register('main/spelplan/template', function(require, exports, module) {module.exports = \"<img src=\\\"/img/spelplan.jpg\\\" class=\\\"card floatRight halfWidth\\\"><div data-bind=\\\"visible:loading\\\" class=\\\"animated fadeIn\\\">Läser in spelplanen...</div><!--ko if: !loading()--><div class=\\\"animated fadeIn\\\"><div class=\\\"marginBottom bigger\\\" data-bind=\\\"with: first\\\"><div class=\\\"red\\\">Nästa spelning <span data-bind=\\\"text: distance\\\"></span></div><div>Datum: <span data-bind=\\\"text: date\\\"></span></div><div>Plats: <span data-bind=\\\"text: place\\\"></span></div></div><div class=\\\"red\\\">Kommande</div><div data-bind=\\\"if:upcoming().length === 0\\\">Inga spelningar inbokade</div><div class=\\\"marginBottom\\\" data-bind=\\\"foreach: upcoming\\\"><div><span class=\\\"bold\\\" data-bind=\\\"text: date\\\"></span> <span data-bind=\\\"text: place\\\"></span></div></div><div data-bind=\\\"if:history().length > 0\\\"><div class=\\\"red\\\">Tidigare</div><div data-bind=\\\"foreach: history\\\"><div><span class=\\\"bold\\\" data-bind=\\\"text: date\\\"></span> <span data-bind=\\\"text: place\\\"></span></div></div></div></div><!--/ko-->\";});\nrequire.register('main/spelplan/view-model', function(require, exports, module) {var request = require('data-request');\n\nmodule.exports = {\n    init: function () {\n        var self = this;\n        this.first = ko.observable();\n        this.upcoming = ko.observableArray();\n        this.history = ko.observableArray();\n        this.loading = ko.observable(true);\n        request.getJson('spelplan', function (gigs) {\n            self.loading(false);\n            gigs.forEach(function (gig) {\n                var gigDate = new Date(gig.date);\n                var now = new Date();\n                now.setHours(0, 0, 0, 0);\n                gigDate.setHours(0, 0, 0, 0);\n                if (now <= gigDate) {\n                    if (!self.first()) {\n                        var diff = dayDiff(now, gigDate);\n                        if (diff === 0) {\n                            gig.distance = 'är idag!';\n                        } else {\n                            gig.distance = 'är om ' + diff + ' dagar';\n                        }\n                        self.first(gig);\n                    } else {\n                        self.upcoming.push(gig);\n                    }\n                } else {\n                    self.history.unshift(gig);\n                }\n            });\n        });\n\n    }\n};\n\nfunction dayDiff(first, second) {\n    return parseInt((second - first) / (1000 * 60 * 60 * 24));\n}});\nrequire.register('main/texter/template', function(require, exports, module) {module.exports = \"<div data-bind=\\\"foreach: lyrics\\\"><div class=\\\"animated fadeIn\\\"><a href=\\\"\\\" data-bind=\\\"text: title, click: click, css: {'bold animated pulse': selected()}\\\"></a></div><div class=\\\"hiddenLyrics\\\" data-bind=\\\"html: text, css: {'visibleLyrics': selected}\\\"></div></div>\";});\nrequire.register('main/texter/view-model', function(require, exports, module) {var request = require('data-request');\n\nmodule.exports = {\n    init: function () {\n        var self = this;\n        this.lyrics = ko.observableArray();\n        self.selected = ko.observable();\n        request.getJson('texter', function (lyricsList) {\n            lyricsList.forEach(function (lyricsItem) {\n                request.getText(lyricsItem.textFile, function (text) {\n                    lyricsItem.text = text.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>');\n                    lyricsItem.selected = ko.observable(false);\n                    lyricsItem.click = function () {\n                        if (lyricsItem.selected()) {\n                            lyricsItem.selected(false);\n                        } else {\n                            self.lyrics().forEach(function (item) {\n                                item.selected(false);\n                            });\n                            lyricsItem.selected(true);\n                        }\n                    };\n                    self.lyrics.push(lyricsItem);\n                });\n            });\n        });\n    }\n};});\nrequire.register('main/video/template', function(require, exports, module) {module.exports = \"<iframe-list params=\\\"items:videos, playIconClass: 'youtube'\\\"></iframe-list>\";});\nrequire.register('main/video/view-model', function(require, exports, module) {var request = require('utils/request');\nvar dataRequest = require('data-request');\n\n\nmodule.exports = {\n    init: function () {\n        var self = this;\n        this.videos = ko.observableArray();\n        dataRequest.getJson('video-artist', function (ids) {\n            var videos = ids.map(function (id) {\n                var video = {\n                    id: id,\n                    iFrameUrl: 'https://www.youtube.com/embed/' + id + '?autoplay=1&autohide=1&origin=http://davidmiles.se',\n                    image: 'url(http://i.ytimg.com/vi/' + id + '/mqdefault.jpg)',\n                    title: ko.observable(),\n                    width: '320px',\n                    height: '180px',\n                    fill: true\n                };\n                request('GET', 'http://gdata.youtube.com/feeds/api/videos/' + video.id + '?alt=json').end(function (result) {\n                    video.title(result.body.entry.title.$t);\n                });\n                return video;\n            });\n            self.videos(videos);\n        });\n    }\n};\n});\nrequire.register('main/video-trubadur/template', function(require, exports, module) {module.exports = \"<div vertical layout>Här kommer det snart finnas videor från Davids trubadurgig...</div>\";});\nrequire.register('main/video-trubadur/view-model', function(require, exports, module) {module.exports = {\n    init: function () {\n\n    }\n};});\nwindow.cogwheels.addFeature({name: \"main\", version: \"0.0.0\"});"],"sourceRoot":"/source/"}